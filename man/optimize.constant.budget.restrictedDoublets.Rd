% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power.R
\name{optimize.constant.budget.restrictedDoublets}
\alias{optimize.constant.budget.restrictedDoublets}
\title{Optimizing cost parameters to maximize detection power for a given budget and 10X design}
\usage{
optimize.constant.budget.restrictedDoublets(
  totalBudget,
  type,
  ct,
  ct.freq,
  costKit,
  costFlowCell,
  readsPerFlowcell,
  ref.study,
  ref.study.name,
  cellsPerLane,
  read.umi.fit,
  gamma.mixed.fits,
  disp.fun.param,
  nSamplesRange = NULL,
  nCellsRange = NULL,
  readDepthRange = NULL,
  mappingEfficiency = 0.8,
  multipletRate = 7.67e-06,
  multipletFactor = 1.82,
  min.UMI.counts = 3,
  perc.indiv.expr = 0.5,
  nGenes = 21000,
  samplingMethod = "quantiles",
  multipletRateGrowth = "linear",
  sign.threshold = 0.05,
  MTmethod = "Bonferroni"
)
}
\arguments{
\item{totalBudget}{Overall experimental budget}

\item{type}{(eqtl/de) study}

\item{ct}{Cell type of interest (name from the gamma mixed models)}

\item{ct.freq}{Frequency of the cell type of interest}

\item{costKit}{Cost for one 10X kit}

\item{costFlowCell}{Cost of one flow cells for sequencing}

\item{readsPerFlowcell}{Number reads that can be sequenced with one flow cell}

\item{ref.study}{Data frame with reference studies to be used for expression ranks and effect sizes
(required columns: name (study name), rank (expression rank), FoldChange (DE study) /Rsq (eQTL study))}

\item{ref.study.name}{Name of the reference study. Will be checked in the ref.study data frame for it (as column name).}

\item{cellsPerLane}{Maximal number of cells per 10X lane}

\item{read.umi.fit}{Data frame for fitting the mean UMI counts per cell depending on the mean readds per cell
(required columns: intercept, reads (slope))}

\item{gamma.mixed.fits}{Data frame with gamma mixed fit parameters for each cell type
(required columns: parameter, ct (cell type), intercept, meanUMI (slope))}

\item{disp.fun.param}{Function to fit the dispersion parameter dependent on the mean
(required columns: ct (cell type), asymptDisp, extraPois (both from taken from DEseq))}

\item{nSamplesRange}{Range of sample sizes that should be tested (vector)}

\item{nCellsRange}{Range of cells per individual that should be tested (vector)}

\item{readDepthRange}{Range of read depth values that should be tested (vector)}

\item{mappingEfficiency}{Fraction of reads successfully mapped to the transcriptome in the end (need to be between 1-0)}

\item{multipletRate}{Expected increase in multiplets for additional cell in the lane}

\item{multipletFactor}{Expected read proportion of multiplet cells vs singlet cells}

\item{min.UMI.counts}{Expression defition parameter: more than is number of UMI counts for each
gene per individual and cell type is required to defined it as expressed in one individual}

\item{perc.indiv.expr}{Expression defition parameter: percentage of individuals that need to have this gene expressed
to define it as globally expressed}

\item{nGenes}{Number of genes to simulate (should match the number of genes used for the fitting)}

\item{samplingMethod}{Approach to sample the gene mean values (either taking quantiles or random sampling)}

\item{multipletRateGrowth}{Development of multiplet rate with increasing number of cells per lane, "linear" if overloading should be
modeled explicitly, otherwise "constant". The default value for the parameter multipletRate is matching the option "linear".}

\item{sign.threshold}{Significance threshold}

\item{MTmethod}{Multiple testing correction method
(possible options: "Bonferroni","FDR","none")}
}
\value{
Data frame with overall detection power, power and expression power for
each possible parameter combination given the budget and the parameter ranges
}
\description{
This function determines the optimal parameter combination for a given budget.
The optimal combination is thereby the one with the highest detection power.
Of the three parameters sample size, cells per sample and read depth, two need to be set and
the third one is uniquely defined given the other two parameters and the overall budget.
}
