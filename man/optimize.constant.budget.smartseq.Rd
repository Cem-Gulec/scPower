% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power.R
\name{optimize.constant.budget.smartseq}
\alias{optimize.constant.budget.smartseq}
\title{Optimizing cost parameters to maximize detection power for a given budget and Smart-seq design}
\usage{
optimize.constant.budget.smartseq(
  totalBudget,
  readDepthRange,
  cellPersRange,
  prepCostCell,
  costFlowCell,
  readsPerFlowcell,
  ct.freq,
  type,
  ref.study,
  ref.study.name,
  gamma.mixed.fits,
  ct,
  disp.fun.param,
  mappingEfficiency = 0.8,
  multipletFraction = 0,
  multipletFactor = 1.82,
  min.norm.count = 10,
  perc.indiv.expr = 0.5,
  nGenes = 21000,
  samplingMethod = "quantiles"
)
}
\arguments{
\item{totalBudget}{Overall experimental budget}

\item{readDepthRange}{Range of read depth values that should be tested (vector)}

\item{cellPersRange}{Range of cells per person that should be tested (vector)}

\item{prepCostCell}{Library preparation costs per cell}

\item{costFlowCell}{Cost of one flow cells for sequencing}

\item{readsPerFlowcell}{Number reads that can be sequenced with one flow cell}

\item{ct.freq}{Frequency of the cell type of interest}

\item{type}{(eqtl/de) study}

\item{ref.study}{Data frame with reference studies to be used for effect sizes and ranks (required columns:)}

\item{ref.study.name}{Name of the reference study. Will be checked in the ref.study data frame for it (as column name).}

\item{gamma.mixed.fits}{Data frame with gamma mixed fit parameters for each cell type (required columns: )}

\item{ct}{Cell type of interest (name from the gamma mixed models)}

\item{disp.fun.param}{Function to fit the dispersion parameter dependent on the mean (required columns:)}

\item{mappingEfficiency}{Fraction of reads successfully mapped to the transcriptome in the end (need to be between 1-0)}

\item{multipletFraction}{Multiplet fraction in the experiment as a constant factor}

\item{multipletFactor}{Expected read proportion of multiplet cells vs singlet cells}

\item{min.norm.count}{Expression defition parameter: more than is number of counts per kilobase transcript for each
gene per person and cell type is required to defined it as expressed in one individual}

\item{perc.indiv.expr}{Expression defition parameter: percentage of individuals that need to have this gene expressed
to define it as globally expressed}

\item{nGenes}{Number of genes to simulate (should match the number of genes used for the fitting)}

\item{samplingMethod}{Approach to sample the gene mean values (either taking quantiles or random sampling)}

\item{totalCost}{Experimental budget}

\item{personsPerLane}{Maximal number of persons per 10X lane}

\item{read.umi.fit}{Data frame for fitting the mean UMI counts per cell depending on the mean readds per cell (required columns: )}
}
\description{
This function determines the optimal parameter combination for a given budget.
The optimal combination is thereby the one with the highest detection power.
The parameters are checked for a range of read depths and cells per person values,
while the sample size is defined uniquely given the other two parameters and
the overall budget.
}
\examples{
optimize.constant.budget(10000,seq(1000,10000,by=1000),seq(1000,10000,by=1000),
5600,14032,4100*10^6,0.2,"de",de.ref.study,"Blueprint (CLL) iCLL-mCLL",8,
read.umi.fit,gamma.mixed.fits,"CD4 T cells",disp.fun.param)

}
